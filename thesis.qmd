---
title: "Biophysical"
format: 
   revealjs:
      theme: default
editor: visual
---

## Background

::: columns
::: {.column width="40%"}
::: incremental
::: r-fit-text
-   Surface chlorophyll has declining phase with increasing warming scenarios and several controversial results have also come in this field
-   Recurring blooms in North eastern Arabian Sea associated with subsurface - chlorophyll maxima(SCM)
-   Extension in stratifications in NEAS & global
-   Satellites shown underestimates in column primary productions
:::
:::
:::

::: {.column width="60%"}
```{r}
library(plotly) 

#Constants 
img_width = 1900 
img_height = 890 
scale_factor = 0.5 

fig <- plot_ly() %>% 
  add_trace( x= c(0, img_width ), 
             y= c(0, img_height ), 
             type = 'scatter',  mode = 'markers', alpha = 0)%>% 
  layout(images = list(  
    list(  
      source =  "ocm_chl_anomaly.png",  
      x=0, 
      sizex=img_width, 
      y=0, 
      sizey=img_height, 
      xref="x", 
      yref="y", 
      opacity=1.0, 
      layer="below" 
    )  
  )) 

xconfig <- list( 
  title = "", 
  showgrid = FALSE, 
  range = c(0, img_width) 
) 

yconfig <- list( 
  title = "", 
  showgrid = FALSE, 
  range = c(img_height,0), 
  scaleanchor="x" 
) 

fig <- fig %>% layout(xaxis = xconfig, yaxis = yconfig) 

#Add lineshape 
#fig <- fig %>%  
#  add_segments(x = 650, xend = 1080, y = 380, yend = 180, line = list( color = #'cyan'),inherit = FALSE, showlegend = FALSE) 

fig <- fig %>% layout(dragmode='drawrect', 
                      newshape=list(line = list(color='cyan')), 
                      title = '') 

#Add modebar buttons 
fig <- fig %>%  
  config(modeBarButtonsToAdd = c('drawline', 
                                 'drawopenpath', 
                                 'drawclosedpath', 
                                 'drawcircle', 
                                 'drawrect', 
                                 'eraseshape',
                                 'drawarrow')) %>%
  layout(plot_bgcolor='#e5ecf6',  
         xaxis = list(showticklabels = FALSE,
           zerolinecolor = '#ffff',  
           zerolinewidth = 2,  
           gridcolor = 'ffff'),  
         yaxis = list(showticklabels = FALSE,
           zerolinecolor = '#ffff',  
           zerolinewidth = 2,  
           gridcolor = 'ffff')  
  )

fig

```
:::
:::
::: footer
chapter 1
:::
## Objectives of the study
::: r-fit-text
::: incremental
Critical Questions to address

-  What are the physical factors influence column productivity and subsurface?
- Which is more in control and immediate effect on the column productivity system of NEAS?
- How climate change and global warming affect the NEAS system as well as the global?
- Constraints and advances in predicting subsurface chlorophyll 
:::
:::

::: footer
chapter 1
:::

::: {.notes}
speaker notes testing
:::

## Code 

![](scm_schem1.png){fig-align="center"}

::: footer
chapter 1
:::

## dfdf

![](scm_schem2.png){fig-align="center"}

::: footer
chapter 1
:::


## SCM 

![](scm_schem3.png){fig-align="left"}


::: footer
chapter 1
:::


## Why SCM is Important ?
::: columns
::: {.column width=40%}
::: incremental
::: r-fit-text
- It is a prominent feature in tropical seas.
- Have  significant contribution in PP
- But mostly it is underestimated  by currently using PP models.
- A significant component varying by seasonality.
- A probe to understand the climate change impacts
:::
:::
:::
::: {.column width=40%}
What are the variations and its patterns?

::: incremental
::: r-fit-text
- Strong inverse correlation between Mixed Layer Depth(MLD) and subsurface chlorophyll Maxima(SCM).
- Atmospheric forcing  and stability of water column are important factors which drives its occurrence.
- Phytoplankton species composition is a major factor on determining the peak magnitudes.
- Species composition is positively correlated with PAR intensity   
:::
:::
:::

:::

::: footer
chapter 1
:::

## Timeline of major studies in Marine chlorophyll dynamics

![](timeline.png){fig-align="left"}


## {auto-animate=true data-background-image="observation_titile.png"}

Study location, Algorithms and sampling

## {auto-animate=true data-background-image="observation_titile.png"}

**Observation & Methods**

Study location, Algorithms and sampling

## Data Sources {data-background-image="datasources_bg.png"}

::: columns
::: {.column width="30%"}
::: incremental
::: r-fit-text
- Bio Argo profiles[2013-2018]
- Insitu CTD profiles[2013-2018]
- Wind data.
- Aqua MODIS PAR data.
- Aqua MODIS Fluorescence
- Tropoflux swr
- From experimental setups
- Phytoplankton published Datasets
:::
:::
:::
:::

##

![](bioargo1.png){fig-align="left"}

##

![](bioargo2.png){fig-align="left"}

## {data-background-image="cruisectd1.png" background-size="1390px"}

## {data-background-image="cruisectd2.png" background-size="1390px"}

::: columns
::: {.column width="50%"}
:::


::: {.column width="50%"}
::: incremental
::: r-fit-text

CTD spec & Probes

- SBE (Model 11 PLUS, Sea-Bird Inc.) in 1 m bin intervals. 
- The CTD system is equipped with auxiliary sensors of dissolved oxygen, fluorescence and photosynthetic active radiation (PAR)

:::
:::
:::
:::


## Study Location 

::: columns
::: {.column width="50%"}

:::


::: {.column width="50%"}

::: incremental
::: r-fit-text

- The study region North Eastern Arabian Sea is monitored using both CTD and BioArgo
- Season- quiescent and warm  month of Spring InterMonsoon
- Preferred sampling from open ocean to find the innate upper ocean dynamics due to stratification


:::
:::

:::
:::

## Algorithms & programing{data-background-image="packagesused.png" background-size="1000px"}

::: columns
::: {.column width="50%"}

:::


::: {.column width="50%"}

::: incremental
::: r-fit-text

   All the Algorithms, Analytics, Automations , Empirical modeling , spatial maps, simulations and documentations are done using R programming Language 




:::
:::

:::
:::

## Clustering and sorting SCMs according to seasons

::: {.r-stack}
![](cluster1.png){.fragment width="450" height="300"}

![](cluster2.png){.fragment width="300" height="450"}

![](cluster3.png){.fragment width="400" height="400"}

![](cluster4.png){.fragment width="400" height="400"}

![](cluster5.png){.fragment width="400" height="400"}


:::

## Fitting with Non-Linear Gaussian curves
::: columns
::: {.column width="60%"}
```{r fits,out.width="100%"}
#first curvefits
chl_argo_ctd<- read.csv("fitdata_1_inter.csv",)
library(ggplot2)
f<- ggplot(chl_argo_ctd,aes(-depth,value,color=Var2))+
  coord_flip()+geom_point(aes(color= Var2))+
  stat_smooth(size=.5, method = "loess", level = 0.95, fullrange = TRUE, se = FALSE)+
  scale_x_continuous(name = "depth(m)")+
  scale_y_continuous(name ="chlorophyll",position = "right")+
  
 # scale_y_continuous(name = expression(paste(chlorophyll,~~( mg/{m}^3))),position = "bottom")+
 labs(colour = "stations")+
 theme(axis.text.x = element_text(size = rel(1.2)),
axis.text.y = element_text(size = rel(1.2)))+
  theme_gray()+
  theme(legend.justification = c(0.9,0.2),
        legend.position = c(1,0),
        legend.box.margin=margin(c(50,50,50,50)),legend.text = element_text(size = 7))

library(plotly)
ggplotly(f)
```

:::


::: {.column width="50%"}
:::
:::


## Fitting with Non-Linear Gaussian curves 

![](profiles1.png){fig-align="center"}

## Fitting with Non-Linear Gaussian curves 

![](profilesfit1.png){fig-align="center"}

## 

![](schematicscm_gauss.png){.r-stretch}

An inverted gaussian can easily represent the SCM

## Rasterizing the fit values

![](fitrast1.png){.r-stretch}

## Rasterizing the fit values

![](fitrast2.png){.r-stretch}

## Surface-subsurface chlorophyll distribution and comparison

![](surf-scm-rast.png){.r-stretch}

## Data strategy for temporal analysis

![](temporaldat1.png){.r-stretch}

## Data strategy for temporal analysis

![](temporaldat2.png){.r-stretch}

## Data strategy for temporal analysis

![](temporaldat3.png){.r-stretch}


## {auto-animate=true data-background-image="observation_titile.png"}

Understanding Process and Interactions 

## {auto-animate=true data-background-image="observation_titile.png"}

**Phytoplankton and Fluid dynamics**

Understanding Process and Interactions 

## 

![](avg_profiles1.png){.r-stretch}

##

![](avg_profiles2.png){.r-stretch}

##

![](avg_profiles3.png){.r-stretch}





## {data-background-image="pca_bg.png" background-size="1500px"}
::: columns

::: {.column width="50%"}


:::

::: {.column width="50%"}

```{r pca3d,out.width="100%"}
marchpca<- read.csv("Marchpcadata.csv")
X <- data.frame(subset(marchpca, select = c(-1, -2, -3,-13, -14, -16,-15)))
prin_comp <- prcomp(X, rank. = 3)


components <- prin_comp[["x"]]
components <- data.frame(components)
components$PC2 <- -components$PC2
components$PC3 <- -components$PC3
components = cbind(components, marchpca$scmmodes)
library(plotly)
fig <- plot_ly(components, x = ~PC1, y = ~PC2, z = ~PC3, color = ~marchpca$scmmodes,
               colors = c('red','darkgreen','blue') ) %>%
  add_markers(size = 12)


fig <- fig %>%
  layout(
    title = "tit",
    scene = list(bgcolor = "#fff")
  )

fig
```

:::
:::



